function setBanner(){function t(){n=++n>a.length-1?0:n,e.removeClass("current"),e.eq(n).addClass("current"),a.removeClass("active");var t=a.eq(n);t.addClass("active"),t.css("opacity","0"),animate(t[0],{opacity:100},40)}var e=$(".circle-list li"),a=$(".banner-list li"),n=0,o=null;e.on("click",function(){if($(this).index()!=n){n=$(this).index(),$(this).addClass("current").siblings("li").removeClass("current"),a.removeClass("active");var t=a.eq(n);t.addClass("active"),t.css("opacity","0"),animate(t[0],{opacity:100},40)}}),o=setInterval(t,3e3),$(".banner-list").mouseenter(function(){clearInterval(o)}),$(".banner-list").mouseleave(function(){o=setInterval(t,3e3)})}function getData(t,e,a,n,o){$.ajax({url:t,type:e,dataType:a,data:n,success:o})}function setAddress(t,e,a,n){$("#"+t+" .select-options").children("li").remove(),$.each(e,function(e,a){var n=$("<li></li>").html(a.name).attr("value",a.code);$("#"+t+" .select-options").append(n)});var o=$("#"+t+" .select-options").children("li:eq(0)").attr("value"),s=$("#"+t+" .select-options").children("li:eq(0)")[0].innerHTML;if($("#"+t+" .select-name").html(s),null!=a){var c={citycode:o,flag:a};getData(config.addressUrl,"get","jsonp",c,n)}}function changeAddress(t,e,a){$("#"+t).mouseenter(function(){$("#"+t+" .select-options").show()}),$("#"+t).mouseleave(function(){$("#"+t+"  .select-options").hide()}),$("#"+t+" .select-options li").click(function(){$("#"+t+" .select-name").html($(this)[0].innerHTML),$("#"+t+" .select-options").hide();$(this).attr("value");if(null!=e){var n={citycode:$(this).attr("value"),flag:e};getData(config.addressUrl,"get","jsonp",n,a)}})}function setOverflowY(t){var e=$("#"+t+" .select-options"),a=$("#"+t+" .select-options li");e.height()<122?(e.css("overflow-y","inherit"),a.css("width","100%")):(e.css("overflow-y","scroll"),a.css("width","93px"))}function createPage(t,e,a,n,o){var s=Math.ceil(t/e);$(".appra-num").html(t);var c=(a+e)/e,r="<div class='rate-page'>";r+=1==c?"<span class='page-prev'>&lt;&lt;上一页</span>":"<a href='javascript:;' class='page-prev'>&lt;&lt;上一页</a>";for(l=1;l<=s;l++)r+=l==c?"<span>"+l+"</span>":"<a href='javascript:;'>"+l+"</a>";r+=c==s?"<span class='page-next'>下一页&gt;&gt;</span>":"<a href='javascript:;' class='page-next'>下一页&gt;&gt;</a>",r+="</div>",$("."+n+" .rate-page").remove(),$("."+n).append($(r)),$(".page-prev").click(function(){if("A"==this.nodeName){var t={flag:2,startIndex:a=e*--c-e,amount:e};getData(config.productUrl,"get","jsonp",t,o)}}),$(".page-next").click(function(){if("A"==this.nodeName){var t={flag:2,startIndex:a=e*++c-e,amount:e};getData(config.productUrl,"get","jsonp",t,o),t={flag:1},getData(config.productUrl,"get","jsonp",t,createPage)}});for(var i=$(".rate-page")[0].children,l=1;l<i.length-1;l++)$(i[l]).click(function(){if("A"==this.nodeName){c=this.innerHTML;var t={flag:2,startIndex:a=e*c-e,amount:e};getData(config.productUrl,"get","jsonp",t,o)}})}function resetData(t){var e=$("."+t).val();return e=Tools.removeAll(e),$("."+t).val(e),e}function showCheckResult(t,e,a,n){0==a?($("."+t+" .notice-info").css("display","inline-block"),e.length>0&&$("."+t+" ."+e).css("border-color","#e22"),$("."+t+" .notice-content").css("color","#e22"),$("."+t+" .notice-icon").css({"background-position":"-17px -100px"})):1==a&&($("."+t+" .notice-info").css("display","inline-block"),$("."+t+" .notice-content").css("color","#3D882D"),$("."+t+" .notice-icon").css({"background-position":"0px -117px"})),$("."+t+" .notice-content")[0].innerHTML=n}function hideCheckResult(t,e){$("."+t+" .notice-info").css("display","none"),e.length>0&&$("."+t+" ."+e).css("border-color","#C2C2C2")}function hideNotice(t){$("."+t+" .tips").hide()}function showNotice(t){$("."+t+" .tips").show()}function checkUsername(){var t=resetData("input-username"),e=t.charAt(0);if(0==t.length)return 1;if(t.length<3||t.length>15)return 2;var a=/^[A-Za-z]*$/;return a.test(e)?(a=/^[A-Za-z0-9_]*$/,a.test(t)?5:4):3}function checkPassword(){var t=resetData("input-password");return 0==t.length?1:t.length<6||t.length>16?2:3}function showUsernameResult(){hideNotice("username");var t=checkUsername();return 1==t?(showCheckResult("username","input-username",0,"请填写用户名"),!1):2==t?(showCheckResult("username","input-username",0,"长度应为3~15个字符"),!1):3==t?(showCheckResult("username","input-username",0,"用户名必需以英文字母开头"),!1):4==t?(showCheckResult("username","input-username",0,"用户名需由字母、数字或下划线组成"),!1):5==t?(showCheckResult("username","input-username",1,"用户名填写正确"),!0):void 0}function showPasswordResult(){hideNotice("password");var t=checkPassword();return 1==t?(showCheckResult("password","input-password",0,"请填写密码"),!1):2==t?(showCheckResult("password","input-password",0,"密码长度应为6~16个字符"),!1):3==t?(showCheckResult("password","input-password",1,"您的密码输入正确"),!0):void 0}function collectionSite(){$(".collection").on("click",function(){$(".cover").show()})}function checkUserStatus(){var t=localStorage.getItem("username");if(null==t||"null"==t){e="欢迎来到慕课网&nbsp;";e+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',e+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(e)}else{var e="欢迎";e+='<a class="showUsername" href="javascript:;">'+t+"</a>",e+="来到慕课网&nbsp;",e+='<a class="exit" href="javascript:;">[退出]</a>',$(".topbar .rightArea").html(e),$(".topbar .exit").on("click",function(){var t="欢迎来到慕课网&nbsp;";t+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',t+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(t),localStorage.setItem("username",null)})}}function getSearchList(){$(".search-box").mouseleave(function(){$(".search-box ul").remove()}),$(".search-text").keyup(function(){$(".search-box ul").remove();var t={code:"utf-8",q:$(".search-text").val(),_ksTS:"1490839958568_2749",jsonpCallback:"jsonp2750",area:"b2c",k:1,bucketid:7,src:"tmall_pc"};getData(config.taobaoUrl,"get","jsonp",t,getSearchResult)})}function getSearchResult(t){var e=t.result;showSearchList(e,$(".search-text").val()),selectResult(e)}function showSearchList(t,e){if(!(t.length<=0)){var a="<ul class='result-list'>";$.each(t,function(t,n){if(a+="<li class='clearfix' value="+t+">",-1==(t=n[0].indexOf(e)))a+="<p class='proName'>"+n[0]+"</p>";else if(0==t)a+="<p class='proName'><em>"+e+"</em>"+n[0].substring(e.length)+"</p>";else if(t==n[0].length-e.length)a+="<p class='proName'>"+n[0].substring(0,n[0].length-e.length)+"<em>"+e+"</em></p>";else{var o=n[0].split(e);a+="<p class='proName'>";for(var s=0;s<o.length-1;s++)a+=o[s],a+="<em>"+e+"</em>";a+=o[o.length-1],a+="</p>"}a+="<p class='resultNum'>约"+n[1]+"个商品</p>",a+="</li>"}),a+="</ul>",$(".search-box").append(a)}}function selectResult(t){var e=$(".result-list li");$.each(e,function(e,a){a.onclick=function(){var e=$(this).attr("value");$(".search-box ul").remove(),$(".search-text").val(t[e][0])}})}function searchData(){$(".search-btn").click(function(){var t=$(".search-text ").val();window.location=config.baiduUrl+"?wd="+t})}function changeNav(){var t=$(".nav li");$.each(t,function(t,e){$(e).click(function(){$(this).addClass("active").siblings("li").removeClass("active"),localStorage.setItem("active",$(this).index())})})}function gotoTop(){$("goTop");var t=0,e=0,a=null;$(window).scroll(function(){$(document).scrollTop()>0?$("#goTop").show():$("#goTop").hide(),t=$(document).scrollTop()}),$("#goTop").on("click",function(){clearInterval(a),e=0,a=setInterval(function(){t+=(e-t)/10,window.scrollTo(0,t),t==e&&clearInterval(a)},10)})}function setProductNum(){var t=parseInt(localStorage.getItem("productNum"));isNaN(t)&&(t=1),$(".shopCar .shopNum").text(t)}function hideDialog(){$(".hide-dialog").on("click",function(){$(".cover").hide()})}function Product(){this.productImage="",this.productName="",this.productPrice="",this.commentNum=""}function hideFilterItem(){$(".screening-box a").on("click",function(){var t=$(this).attr("data"),e=$(this).attr("position");$("."+t).hide(),$("."+e).show(),$("."+e+"-text").html(this.innerHTML)})}function showFilterItem(){$(".userPosition a").on("click",function(){$(this).parent().hide();var t=$(this).attr("data-class");$("."+t).show()})}function showPage(t){var e=Math.ceil(t/config.productAmount);$(".total-page").html(e),$(".product-num").html(t);var a=(config.productStartIndex+config.productAmount)/config.productAmount;$(".now-page").html(a);var n="<div class='rate-page'>";n+=1==a?"<span class='page-prev'>&lt;&lt;上一页</span>":"<a href='javascript:;' class='page-prev'>&lt;&lt;上一页</a>";for(s=1;s<=e;s++)n+=s==a?"<span>"+s+"</span>":"<a href='javascript:;'>"+s+"</a>";n+=a==e?"<span class='page-next'>下一页&gt;&gt;</span>":"<a href='javascript:;' class='page-next'>下一页&gt;&gt;</a>",n+="</div>",$(".page-box .rate-page").remove(),$(".page-box").append($(n)),$(".page-prev").click(function(){"A"==this.nodeName&&(a--,config.productStartIndex=config.productAmount*a-config.productAmount,getProductInfo())}),$(".page-next").click(function(){"A"==this.nodeName&&(a++,config.productStartIndex=config.productAmount*a-config.productAmount,getProductInfo())});for(var o=$(".rate-page")[0].children,s=1;s<o.length-1;s++)$(o[s]).click(function(){"A"==this.nodeName&&(a=this.innerHTML,config.productStartIndex=config.productAmount*a-config.productAmount,getProductInfo())})}function getProductInfo(){var t={flag:2,startIndex:config.productStartIndex,amount:config.productAmount};getData(config.productUrl,"get","jsonp",t,showProductInfo),t={flag:1},getData(config.productUrl,"get","jsonp",t,showPage)}var config={addressUrl:"http://localhost/dswzServer/place.php",advisoryUrl:"http://localhost/dswzServer/advisory.php",productUrl:"http://localhost/dswzServer/product.php",taobaoUrl:"https://suggest.taobao.com/sug",baiduUrl:"http://www.baidu.com/s",registerUrl:"http://localhost/dswzServer/register.php",loginUrl:"http://localhost/dswzServer/login.php",advisoryStartIndex:0,advisoryAmount:5,productStartIndex:0,productAmount:6};$(function(){collectionSite(),checkUserStatus(),getSearchList(),searchData(),changeNav(),gotoTop(),setProductNum(),hideDialog()}),Product.prototype={bindDOM:function(){var t="";return t+='<li class="brick-item">',t+='<a href="proinfo.html">',t+='<div class="p-image">',t+='<img src="'+this.productImage+'" width="150" height="150" alt="">',t+="</div>",t+='<div class="p-name">'+this.productName+"</div>",t+='<div class="p-price"><span class="num">'+this.productPrice+"</span>元</div>",t+='<p class="p-comment">'+this.commentNum+"人评价</p>",t+="</a>",t+="</li>"}},$(function(){hideFilterItem(),showFilterItem(),getProductInfo()});var showProductInfo=function(t){var e="";$.each(t,function(t,a){var n=new Product;n.productImage=a.productimage,n.productName=a.productname,n.productPrice=a.productprice,n.commentNum=a.commentnum,e+=n.bindDOM()}),$(".brick-list").html(e)};