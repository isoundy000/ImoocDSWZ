function animate(e,t,s,a){clearInterval(e.timer),e.timer=setInterval(function(){var s=!0;for(var n in t){var o=0;o="opacity"==n?Math.round(parseInt(100*getStyle(e,n)))||0:parseInt(getStyle(e,n));var i=(t[n]-o)/10;i=i>0?Math.ceil(i):Math.floor(i),"opacity"==n?"opacity"in e.style?e.style.opacity=(o+i)/100:e.style.filter="alpha(opacity = "+10*(o+i)+")":"zIndex"==n?e.style.zIndex=t[n]:e.style[n]=o+i+"px",o!=t[n]&&(s=!1)}s&&(clearInterval(e.timer),a&&a())},s)}function getStyle(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle(e,null)[t]}function setBanner(){function e(){a=++a>s.length-1?0:a,t.removeClass("current"),t.eq(a).addClass("current"),s.removeClass("active");var e=s.eq(a);e.addClass("active"),e.css("opacity","0"),animate(e[0],{opacity:100},40)}var t=$(".circle-list li"),s=$(".banner-list li"),a=0,n=null;t.on("click",function(){if($(this).index()!=a){a=$(this).index(),$(this).addClass("current").siblings("li").removeClass("current"),s.removeClass("active");var e=s.eq(a);e.addClass("active"),e.css("opacity","0"),animate(e[0],{opacity:100},40)}}),n=setInterval(e,3e3),$(".banner-list").mouseenter(function(){clearInterval(n)}),$(".banner-list").mouseleave(function(){n=setInterval(e,3e3)})}function getData(e,t,s,a,n){$.ajax({url:e,type:t,dataType:s,data:a,success:n})}function setAddress(e,t,s,a){$("#"+e+" .select-options").children("li").remove(),$.each(t,function(t,s){var a=$("<li></li>").html(s.name).attr("value",s.code);$("#"+e+" .select-options").append(a)});var n=$("#"+e+" .select-options").children("li:eq(0)").attr("value"),o=$("#"+e+" .select-options").children("li:eq(0)")[0].innerHTML;if($("#"+e+" .select-name").html(o),null!=s){var i={citycode:n,flag:s};getData(config.addressUrl,"get","jsonp",i,a)}}function changeAddress(e,t,s){$("#"+e).mouseenter(function(){$("#"+e+" .select-options").show()}),$("#"+e).mouseleave(function(){$("#"+e+"  .select-options").hide()}),$("#"+e+" .select-options li").click(function(){$("#"+e+" .select-name").html($(this)[0].innerHTML),$("#"+e+" .select-options").hide();$(this).attr("value");if(null!=t){var a={citycode:$(this).attr("value"),flag:t};getData(config.addressUrl,"get","jsonp",a,s)}})}function setOverflowY(e){var t=$("#"+e+" .select-options"),s=$("#"+e+" .select-options li");t.height()<122?(t.css("overflow-y","inherit"),s.css("width","100%")):(t.css("overflow-y","scroll"),s.css("width","93px"))}function createPage(e,t,s,a,n){var o=Math.ceil(e/t);$(".appra-num").html(e);var i=(s+t)/t,r="<div class='rate-page'>";r+=1==i?"<span class='page-prev'>&lt;&lt;上一页</span>":"<a href='javascript:;' class='page-prev'>&lt;&lt;上一页</a>";for(l=1;l<=o;l++)r+=l==i?"<span>"+l+"</span>":"<a href='javascript:;'>"+l+"</a>";r+=i==o?"<span class='page-next'>下一页&gt;&gt;</span>":"<a href='javascript:;' class='page-next'>下一页&gt;&gt;</a>",r+="</div>",$("."+a+" .rate-page").remove(),$("."+a).append($(r)),$(".page-prev").click(function(){if("A"==this.nodeName){var e={flag:2,startIndex:s=t*--i-t,amount:t};getData(config.productUrl,"get","jsonp",e,n)}}),$(".page-next").click(function(){if("A"==this.nodeName){var e={flag:2,startIndex:s=t*++i-t,amount:t};getData(config.productUrl,"get","jsonp",e,n),e={flag:1},getData(config.productUrl,"get","jsonp",e,createPage)}});for(var c=$(".rate-page")[0].children,l=1;l<c.length-1;l++)$(c[l]).click(function(){if("A"==this.nodeName){i=this.innerHTML;var e={flag:2,startIndex:s=t*i-t,amount:t};getData(config.productUrl,"get","jsonp",e,n)}})}function resetData(e){var t=$("."+e).val();return t=Tools.removeAll(t),$("."+e).val(t),t}function showCheckResult(e,t,s,a){0==s?($("."+e+" .notice-info").css("display","inline-block"),t.length>0&&$("."+e+" ."+t).css("border-color","#e22"),$("."+e+" .notice-content").css("color","#e22"),$("."+e+" .notice-icon").css({"background-position":"-17px -100px"})):1==s&&($("."+e+" .notice-info").css("display","inline-block"),$("."+e+" .notice-content").css("color","#3D882D"),$("."+e+" .notice-icon").css({"background-position":"0px -117px"})),$("."+e+" .notice-content")[0].innerHTML=a}function hideCheckResult(e,t){$("."+e+" .notice-info").css("display","none"),t.length>0&&$("."+e+" ."+t).css("border-color","#C2C2C2")}function hideNotice(e){$("."+e+" .tips").hide()}function showNotice(e){$("."+e+" .tips").show()}function checkUsername(){var e=resetData("input-username"),t=e.charAt(0);if(0==e.length)return 1;if(e.length<3||e.length>15)return 2;var s=/^[A-Za-z]*$/;return s.test(t)?(s=/^[A-Za-z0-9_]*$/,s.test(e)?5:4):3}function checkPassword(){var e=resetData("input-password");return 0==e.length?1:e.length<6||e.length>16?2:3}function showUsernameResult(){hideNotice("username");var e=checkUsername();return 1==e?(showCheckResult("username","input-username",0,"请填写用户名"),!1):2==e?(showCheckResult("username","input-username",0,"长度应为3~15个字符"),!1):3==e?(showCheckResult("username","input-username",0,"用户名必需以英文字母开头"),!1):4==e?(showCheckResult("username","input-username",0,"用户名需由字母、数字或下划线组成"),!1):5==e?(showCheckResult("username","input-username",1,"用户名填写正确"),!0):void 0}function showPasswordResult(){hideNotice("password");var e=checkPassword();return 1==e?(showCheckResult("password","input-password",0,"请填写密码"),!1):2==e?(showCheckResult("password","input-password",0,"密码长度应为6~16个字符"),!1):3==e?(showCheckResult("password","input-password",1,"您的密码输入正确"),!0):void 0}function collectionSite(){$(".collection").on("click",function(){$(".cover").show()})}function checkUserStatus(){var e=localStorage.getItem("username");if(null==e||"null"==e){t="欢迎来到慕课网&nbsp;";t+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',t+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(t)}else{var t="欢迎";t+='<a class="showUsername" href="javascript:;">'+e+"</a>",t+="来到慕课网&nbsp;",t+='<a class="exit" href="javascript:;">[退出]</a>',$(".topbar .rightArea").html(t),$(".topbar .exit").on("click",function(){var e="欢迎来到慕课网&nbsp;";e+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',e+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(e),localStorage.setItem("username",null)})}}function getSearchList(){$(".search-box").mouseleave(function(){$(".search-box ul").remove()}),$(".search-text").keyup(function(){$(".search-box ul").remove();var e={code:"utf-8",q:$(".search-text").val(),_ksTS:"1490839958568_2749",jsonpCallback:"jsonp2750",area:"b2c",k:1,bucketid:7,src:"tmall_pc"};getData(config.taobaoUrl,"get","jsonp",e,getSearchResult)})}function getSearchResult(e){var t=e.result;showSearchList(t,$(".search-text").val()),selectResult(t)}function showSearchList(e,t){if(!(e.length<=0)){var s="<ul class='result-list'>";$.each(e,function(e,a){if(s+="<li class='clearfix' value="+e+">",-1==(e=a[0].indexOf(t)))s+="<p class='proName'>"+a[0]+"</p>";else if(0==e)s+="<p class='proName'><em>"+t+"</em>"+a[0].substring(t.length)+"</p>";else if(e==a[0].length-t.length)s+="<p class='proName'>"+a[0].substring(0,a[0].length-t.length)+"<em>"+t+"</em></p>";else{var n=a[0].split(t);s+="<p class='proName'>";for(var o=0;o<n.length-1;o++)s+=n[o],s+="<em>"+t+"</em>";s+=n[n.length-1],s+="</p>"}s+="<p class='resultNum'>约"+a[1]+"个商品</p>",s+="</li>"}),s+="</ul>",$(".search-box").append(s)}}function selectResult(e){var t=$(".result-list li");$.each(t,function(t,s){s.onclick=function(){var t=$(this).attr("value");$(".search-box ul").remove(),$(".search-text").val(e[t][0])}})}function searchData(){$(".search-btn").click(function(){var e=$(".search-text ").val();window.location=config.baiduUrl+"?wd="+e})}function changeNav(){var e=$(".nav li");$.each(e,function(e,t){$(t).click(function(){$(this).addClass("active").siblings("li").removeClass("active"),localStorage.setItem("active",$(this).index())})})}function gotoTop(){$("goTop");var e=0,t=0,s=null;$(window).scroll(function(){$(document).scrollTop()>0?$("#goTop").show():$("#goTop").hide(),e=$(document).scrollTop()}),$("#goTop").on("click",function(){clearInterval(s),t=0,s=setInterval(function(){e+=(t-e)/10,window.scrollTo(0,e),e==t&&clearInterval(s)},10)})}function setProductNum(){var e=parseInt(localStorage.getItem("productNum"));isNaN(e)&&(e=1),$(".shopCar .shopNum").text(e)}function hideDialog(){$(".hide-dialog").on("click",function(){$(".cover").hide()})}function setShopClass(){$(".shopClass-item").mouseenter(function(){$(this).addClass("active").siblings("dl").removeClass("active"),$(".shopClass-list .cate-item").css("display","none"),$(".shopClass-list .cate-item").eq($(this).index()).css("display","block")}),$(".shopClassBar").mouseleave(function(){$(".shopClass-item").removeClass("active"),$(".shopClass-list .cate-item").css("display","none")})}var config={addressUrl:"http://localhost/dswzServer/place.php",advisoryUrl:"http://localhost/dswzServer/advisory.php",productUrl:"http://localhost/dswzServer/product.php",taobaoUrl:"https://suggest.taobao.com/sug",baiduUrl:"http://www.baidu.com/s",registerUrl:"http://localhost/dswzServer/register.php",loginUrl:"http://localhost/dswzServer/login.php",advisoryStartIndex:0,advisoryAmount:5,productStartIndex:0,productAmount:6};$(function(){collectionSite(),checkUserStatus(),getSearchList(),searchData(),changeNav(),gotoTop(),setProductNum(),hideDialog()}),$(function(){setShopClass(),setBanner()});