function animate(e,t,a,n){clearInterval(e.timer),e.timer=setInterval(function(){var a=!0;for(var s in t){var o=0;o="opacity"==s?Math.round(parseInt(100*getStyle(e,s)))||0:parseInt(getStyle(e,s));var r=(t[s]-o)/10;r=r>0?Math.ceil(r):Math.floor(r),"opacity"==s?"opacity"in e.style?e.style.opacity=(o+r)/100:e.style.filter="alpha(opacity = "+10*(o+r)+")":"zIndex"==s?e.style.zIndex=t[s]:e.style[s]=o+r+"px",o!=t[s]&&(a=!1)}a&&(clearInterval(e.timer),n&&n())},a)}function getStyle(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle(e,null)[t]}function setBanner(){function e(){n=++n>a.length-1?0:n,t.removeClass("current"),t.eq(n).addClass("current"),a.removeClass("active");var e=a.eq(n);e.addClass("active"),e.css("opacity","0"),animate(e[0],{opacity:100},40)}var t=$(".circle-list li"),a=$(".banner-list li"),n=0,s=null;t.on("click",function(){if($(this).index()!=n){n=$(this).index(),$(this).addClass("current").siblings("li").removeClass("current"),a.removeClass("active");var e=a.eq(n);e.addClass("active"),e.css("opacity","0"),animate(e[0],{opacity:100},40)}}),s=setInterval(e,3e3),$(".banner-list").mouseenter(function(){clearInterval(s)}),$(".banner-list").mouseleave(function(){s=setInterval(e,3e3)})}function getData(e,t,a,n,s){$.ajax({url:e,type:t,dataType:a,data:n,success:s})}function setAddress(e,t,a,n){$("#"+e+" .select-options").children("li").remove(),$.each(t,function(t,a){var n=$("<li></li>").html(a.name).attr("value",a.code);$("#"+e+" .select-options").append(n)});var s=$("#"+e+" .select-options").children("li:eq(0)").attr("value"),o=$("#"+e+" .select-options").children("li:eq(0)")[0].innerHTML;if($("#"+e+" .select-name").html(o),null!=a){var r={citycode:s,flag:a};getData(config.addressUrl,"get","jsonp",r,n)}}function changeAddress(e,t,a){$("#"+e).mouseenter(function(){$("#"+e+" .select-options").show()}),$("#"+e).mouseleave(function(){$("#"+e+"  .select-options").hide()}),$("#"+e+" .select-options li").click(function(){$("#"+e+" .select-name").html($(this)[0].innerHTML),$("#"+e+" .select-options").hide();$(this).attr("value");if(null!=t){var n={citycode:$(this).attr("value"),flag:t};getData(config.addressUrl,"get","jsonp",n,a)}})}function setOverflowY(e){var t=$("#"+e+" .select-options"),a=$("#"+e+" .select-options li");t.height()<122?(t.css("overflow-y","inherit"),a.css("width","100%")):(t.css("overflow-y","scroll"),a.css("width","93px"))}function createPage(e,t,a,n,s){var o=Math.ceil(e/t);$(".appra-num").html(e);var r=(a+t)/t,c="<div class='rate-page'>";c+=1==r?"<span class='page-prev'>&lt;&lt;上一页</span>":"<a href='javascript:;' class='page-prev'>&lt;&lt;上一页</a>";for(l=1;l<=o;l++)c+=l==r?"<span>"+l+"</span>":"<a href='javascript:;'>"+l+"</a>";c+=r==o?"<span class='page-next'>下一页&gt;&gt;</span>":"<a href='javascript:;' class='page-next'>下一页&gt;&gt;</a>",c+="</div>",$("."+n+" .rate-page").remove(),$("."+n).append($(c)),$(".page-prev").click(function(){if("A"==this.nodeName){var e={flag:2,startIndex:a=t*--r-t,amount:t};getData(config.productUrl,"get","jsonp",e,s)}}),$(".page-next").click(function(){if("A"==this.nodeName){var e={flag:2,startIndex:a=t*++r-t,amount:t};getData(config.productUrl,"get","jsonp",e,s),e={flag:1},getData(config.productUrl,"get","jsonp",e,createPage)}});for(var i=$(".rate-page")[0].children,l=1;l<i.length-1;l++)$(i[l]).click(function(){if("A"==this.nodeName){r=this.innerHTML;var e={flag:2,startIndex:a=t*r-t,amount:t};getData(config.productUrl,"get","jsonp",e,s)}})}function resetData(e){var t=$("."+e).val();return t=Tools.removeAll(t),$("."+e).val(t),t}function showCheckResult(e,t,a,n){0==a?($("."+e+" .notice-info").css("display","inline-block"),t.length>0&&$("."+e+" ."+t).css("border-color","#e22"),$("."+e+" .notice-content").css("color","#e22"),$("."+e+" .notice-icon").css({"background-position":"-17px -100px"})):1==a&&($("."+e+" .notice-info").css("display","inline-block"),$("."+e+" .notice-content").css("color","#3D882D"),$("."+e+" .notice-icon").css({"background-position":"0px -117px"})),$("."+e+" .notice-content")[0].innerHTML=n}function hideCheckResult(e,t){$("."+e+" .notice-info").css("display","none"),t.length>0&&$("."+e+" ."+t).css("border-color","#C2C2C2")}function hideNotice(e){$("."+e+" .tips").hide()}function showNotice(e){$("."+e+" .tips").show()}function checkUsername(){var e=resetData("input-username"),t=e.charAt(0);if(0==e.length)return 1;if(e.length<3||e.length>15)return 2;var a=/^[A-Za-z]*$/;return a.test(t)?(a=/^[A-Za-z0-9_]*$/,a.test(e)?5:4):3}function checkPassword(){var e=resetData("input-password");return 0==e.length?1:e.length<6||e.length>16?2:3}function showUsernameResult(){hideNotice("username");var e=checkUsername();return 1==e?(showCheckResult("username","input-username",0,"请填写用户名"),!1):2==e?(showCheckResult("username","input-username",0,"长度应为3~15个字符"),!1):3==e?(showCheckResult("username","input-username",0,"用户名必需以英文字母开头"),!1):4==e?(showCheckResult("username","input-username",0,"用户名需由字母、数字或下划线组成"),!1):5==e?(showCheckResult("username","input-username",1,"用户名填写正确"),!0):void 0}function showPasswordResult(){hideNotice("password");var e=checkPassword();return 1==e?(showCheckResult("password","input-password",0,"请填写密码"),!1):2==e?(showCheckResult("password","input-password",0,"密码长度应为6~16个字符"),!1):3==e?(showCheckResult("password","input-password",1,"您的密码输入正确"),!0):void 0}function collectionSite(){$(".collection").on("click",function(){$(".cover").show()})}function checkUserStatus(){var e=localStorage.getItem("username");if(null==e||"null"==e){t="欢迎来到慕课网&nbsp;";t+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',t+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(t)}else{var t="欢迎";t+='<a class="showUsername" href="javascript:;">'+e+"</a>",t+="来到慕课网&nbsp;",t+='<a class="exit" href="javascript:;">[退出]</a>',$(".topbar .rightArea").html(t),$(".topbar .exit").on("click",function(){var e="欢迎来到慕课网&nbsp;";e+='<a class="loginLink" href="login.html">[登录]</a>&nbsp;',e+='<a class="registerLink" href="register.html">[免费注册]</a>',$(".topbar .rightArea").html(e),localStorage.setItem("username",null)})}}function getSearchList(){$(".search-box").mouseleave(function(){$(".search-box ul").remove()}),$(".search-text").keyup(function(){$(".search-box ul").remove();var e={code:"utf-8",q:$(".search-text").val(),_ksTS:"1490839958568_2749",jsonpCallback:"jsonp2750",area:"b2c",k:1,bucketid:7,src:"tmall_pc"};getData(config.taobaoUrl,"get","jsonp",e,getSearchResult)})}function getSearchResult(e){var t=e.result;showSearchList(t,$(".search-text").val()),selectResult(t)}function showSearchList(e,t){if(!(e.length<=0)){var a="<ul class='result-list'>";$.each(e,function(e,n){if(a+="<li class='clearfix' value="+e+">",-1==(e=n[0].indexOf(t)))a+="<p class='proName'>"+n[0]+"</p>";else if(0==e)a+="<p class='proName'><em>"+t+"</em>"+n[0].substring(t.length)+"</p>";else if(e==n[0].length-t.length)a+="<p class='proName'>"+n[0].substring(0,n[0].length-t.length)+"<em>"+t+"</em></p>";else{var s=n[0].split(t);a+="<p class='proName'>";for(var o=0;o<s.length-1;o++)a+=s[o],a+="<em>"+t+"</em>";a+=s[s.length-1],a+="</p>"}a+="<p class='resultNum'>约"+n[1]+"个商品</p>",a+="</li>"}),a+="</ul>",$(".search-box").append(a)}}function selectResult(e){var t=$(".result-list li");$.each(t,function(t,a){a.onclick=function(){var t=$(this).attr("value");$(".search-box ul").remove(),$(".search-text").val(e[t][0])}})}function searchData(){$(".search-btn").click(function(){var e=$(".search-text ").val();window.location=config.baiduUrl+"?wd="+e})}function changeNav(){var e=$(".nav li");$.each(e,function(e,t){$(t).click(function(){$(this).addClass("active").siblings("li").removeClass("active"),localStorage.setItem("active",$(this).index())})})}function gotoTop(){$("goTop");var e=0,t=0,a=null;$(window).scroll(function(){$(document).scrollTop()>0?$("#goTop").show():$("#goTop").hide(),e=$(document).scrollTop()}),$("#goTop").on("click",function(){clearInterval(a),t=0,a=setInterval(function(){e+=(t-e)/10,window.scrollTo(0,e),e==t&&clearInterval(a)},10)})}function setProductNum(){var e=parseInt(localStorage.getItem("productNum"));isNaN(e)&&(e=1),$(".shopCar .shopNum").text(e)}function hideDialog(){$(".hide-dialog").on("click",function(){$(".cover").hide()})}function setNav(){var e=$(".nav li").length,t=parseInt(localStorage.getItem("active"));localStorage.setItem("active",0),t>=0&&t<e&&$(".nav li").eq(t).addClass("active").siblings("li").removeClass("active")}function gotoComment(){$(".commentNum").on("click",function(){localStorage.setItem("flag",1),window.location="proinfo.html"})}function saveData(){}var config={addressUrl:"http://localhost/dswzServer/place.php",advisoryUrl:"http://localhost/dswzServer/advisory.php",productUrl:"http://localhost/dswzServer/product.php",taobaoUrl:"https://suggest.taobao.com/sug",baiduUrl:"http://www.baidu.com/s",registerUrl:"http://localhost/dswzServer/register.php",loginUrl:"http://localhost/dswzServer/login.php",advisoryStartIndex:0,advisoryAmount:5,productStartIndex:0,productAmount:6};$(function(){collectionSite(),checkUserStatus(),getSearchList(),searchData(),changeNav(),gotoTop(),setProductNum(),hideDialog()}),$(function(){setNav(),setBanner(),saveData(),gotoComment()});